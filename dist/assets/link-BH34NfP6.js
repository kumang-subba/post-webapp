(function(){try{if(typeof document<"u"){var k=document.createElement("style");k.appendChild(document.createTextNode(`.link-tool{position:relative}.link-tool__input{padding-left:38px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none'%3E%3Cpath stroke='%23707684' stroke-linecap='round' stroke-width='2' d='m7.7 12.6-.021.02a2.795 2.795 0 0 0-.044 4.005v0a2.795 2.795 0 0 0 3.936.006l1.455-1.438a3 3 0 0 0 .34-3.866l-.146-.207'/%3E%3Cpath stroke='%23707684' stroke-linecap='round' stroke-width='2' d='m16.22 11.12.136-.14c.933-.954.992-2.46.135-3.483v0a2.597 2.597 0 0 0-3.664-.32L11.39 8.386a3 3 0 0 0-.301 4.3l.031.034'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:10px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.link-tool__input-holder{position:relative}.link-tool__input-holder--error .link-tool__input{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none'%3E%3Cpath stroke='rgb(224, 147, 147)' stroke-linecap='round' stroke-width='2' d='m7.7 12.6-.021.02a2.795 2.795 0 0 0-.044 4.005v0a2.795 2.795 0 0 0 3.936.006l1.455-1.438a3 3 0 0 0 .34-3.866l-.146-.207'/%3E%3Cpath stroke='rgb(224, 147, 147)' stroke-linecap='round' stroke-width='2' d='m16.22 11.12.136-.14c.933-.954.992-2.46.135-3.483v0a2.597 2.597 0 0 0-3.664-.32L11.39 8.386a3 3 0 0 0-.301 4.3l.031.034'/%3E%3C/svg%3E");background-color:#fff3f6;border-color:#f3e0e0;color:#a95a5a;box-shadow:inset 0 1px 3px #923e3e0d}.link-tool__input[contentEditable=true][data-placeholder]:before{position:absolute;content:attr(data-placeholder);color:#707684;font-weight:400;opacity:0}.link-tool__input[contentEditable=true][data-placeholder]:empty:before{opacity:1}.link-tool__input[contentEditable=true][data-placeholder]:empty:focus:before{opacity:0}.link-tool__progress{position:absolute;box-shadow:inset 0 1px 3px #66556b0a;height:100%;width:0;background-color:#f4f5f7;z-index:-1}.link-tool__progress--loading{-webkit-animation:progress .5s ease-in;-webkit-animation-fill-mode:forwards}.link-tool__progress--loaded{width:100%}.link-tool__content{display:block;padding:25px;border-radius:2px;box-shadow:0 0 0 2px #fff;color:initial!important;text-decoration:none!important}.link-tool__content:after{content:"";clear:both;display:table}.link-tool__content--rendered{background:#fff;border:1px solid rgba(201,201,204,.48);box-shadow:0 1px 3px #0000001a;border-radius:6px;will-change:filter;animation:link-in .45s 1 cubic-bezier(.215,.61,.355,1)}.link-tool__content--rendered:hover{box-shadow:0 0 3px #00000029}.link-tool__image{background-position:center center;background-repeat:no-repeat;background-size:cover;margin:0 0 0 30px;width:65px;height:65px;border-radius:3px;float:right}.link-tool__title{font-size:17px;font-weight:600;line-height:1.5em;margin:0 0 10px}.link-tool__title+.link-tool__anchor{margin-top:25px}.link-tool__description{margin:0 0 20px;font-size:15px;line-height:1.55em;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.link-tool__anchor{display:block;font-size:15px;line-height:1em;color:#888!important;border:0!important;padding:0!important}@keyframes link-in{0%{filter:blur(5px)}to{filter:none}}.codex-editor--narrow .link-tool__image{display:none}@-webkit-keyframes progress{0%{width:0}to{width:85%}}`)),document.head.appendChild(k)}}catch(b){console.error("vite-plugin-css-injected-by-js",b)}})();var x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}(function(k){var b=function(){try{return!!Symbol.iterator}catch{return!1}},f=b(),g=function(n){var o={next:function(){var t=n.shift();return{done:t===void 0,value:t}}};return f&&(o[Symbol.iterator]=function(){return o}),o},c=function(n){return encodeURIComponent(n).replace(/%20/g,"+")},i=function(n){return decodeURIComponent(String(n).replace(/\+/g," "))},a=function(){var n=function(t){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var s=typeof t;if(s!=="undefined")if(s==="string")t!==""&&this._fromString(t);else if(t instanceof n){var h=this;t.forEach(function(l,d){h.append(d,l)})}else if(t!==null&&s==="object")if(Object.prototype.toString.call(t)==="[object Array]")for(var e=0;e<t.length;e++){var v=t[e];if(Object.prototype.toString.call(v)==="[object Array]"||v.length!==2)this.append(v[0],v[1]);else throw new TypeError("Expected [string, any] as entry at index "+e+" of URLSearchParams's input")}else for(var r in t)t.hasOwnProperty(r)&&this.append(r,t[r]);else throw new TypeError("Unsupported input's type for URLSearchParams")},o=n.prototype;o.append=function(t,s){t in this._entries?this._entries[t].push(String(s)):this._entries[t]=[String(s)]},o.delete=function(t){delete this._entries[t]},o.get=function(t){return t in this._entries?this._entries[t][0]:null},o.getAll=function(t){return t in this._entries?this._entries[t].slice(0):[]},o.has=function(t){return t in this._entries},o.set=function(t,s){this._entries[t]=[String(s)]},o.forEach=function(t,s){var h;for(var e in this._entries)if(this._entries.hasOwnProperty(e)){h=this._entries[e];for(var v=0;v<h.length;v++)t.call(s,h[v],e,this)}},o.keys=function(){var t=[];return this.forEach(function(s,h){t.push(h)}),g(t)},o.values=function(){var t=[];return this.forEach(function(s){t.push(s)}),g(t)},o.entries=function(){var t=[];return this.forEach(function(s,h){t.push([h,s])}),g(t)},f&&(o[Symbol.iterator]=o.entries),o.toString=function(){var t=[];return this.forEach(function(s,h){t.push(c(h)+"="+c(s))}),t.join("&")},k.URLSearchParams=n},p=function(){try{var n=k.URLSearchParams;return new n("?a=1").toString()==="a=1"&&typeof n.prototype.set=="function"}catch{return!1}};p()||a();var u=k.URLSearchParams.prototype;typeof u.sort!="function"&&(u.sort=function(){var n=this,o=[];this.forEach(function(s,h){o.push([h,s]),n._entries||n.delete(h)}),o.sort(function(s,h){return s[0]<h[0]?-1:s[0]>h[0]?1:0}),n._entries&&(n._entries={});for(var t=0;t<o.length;t++)this.append(o[t][0],o[t][1])}),typeof u._fromString!="function"&&Object.defineProperty(u,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(n){if(this._entries)this._entries={};else{var o=[];this.forEach(function(e,v){o.push(v)});for(var t=0;t<o.length;t++)this.delete(o[t])}n=n.replace(/^\?/,"");for(var s=n.split("&"),h,t=0;t<s.length;t++)h=s[t].split("="),this.append(i(h[0]),h.length>1?i(h[1]):"")}})})(typeof x<"u"?x:typeof window<"u"?window:typeof self<"u"?self:x);(function(k){var b=function(){try{var c=new k.URL("b","http://a");return c.pathname="c d",c.href==="http://a/c%20d"&&c.searchParams}catch{return!1}},f=function(){var c=k.URL,i=function(u,n){typeof u!="string"&&(u=String(u));var o=document,t;if(n&&(k.location===void 0||n!==k.location.href)){o=document.implementation.createHTMLDocument(""),t=o.createElement("base"),t.href=n,o.head.appendChild(t);try{if(t.href.indexOf(n)!==0)throw new Error(t.href)}catch(m){throw new Error("URL unable to set base "+n+" due to "+m)}}var s=o.createElement("a");s.href=u,t&&(o.body.appendChild(s),s.href=s.href);var h=o.createElement("input");if(h.type="url",h.value=u,s.protocol===":"||!/:/.test(s.href)||!h.checkValidity()&&!n)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:s});var e=new k.URLSearchParams(this.search),v=!0,r=!0,l=this;["append","delete","set"].forEach(function(m){var w=e[m];e[m]=function(){w.apply(e,arguments),v&&(r=!1,l.search=e.toString(),r=!0)}}),Object.defineProperty(this,"searchParams",{value:e,enumerable:!0});var d=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==d&&(d=this.search,r&&(v=!1,this.searchParams._fromString(this.search),v=!0))}})},a=i.prototype,p=function(u){Object.defineProperty(a,u,{get:function(){return this._anchorElement[u]},set:function(n){this._anchorElement[u]=n},enumerable:!0})};["hash","host","hostname","port","protocol"].forEach(function(u){p(u)}),Object.defineProperty(a,"search",{get:function(){return this._anchorElement.search},set:function(u){this._anchorElement.search=u,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(a,{toString:{get:function(){var u=this;return function(){return u.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(u){this._anchorElement.href=u,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(u){this._anchorElement.pathname=u},enumerable:!0},origin:{get:function(){var u={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],n=this._anchorElement.port!=u&&this._anchorElement.port!=="";return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(n?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(u){},enumerable:!0},username:{get:function(){return""},set:function(u){},enumerable:!0}}),i.createObjectURL=function(u){return c.createObjectURL.apply(c,arguments)},i.revokeObjectURL=function(u){return c.revokeObjectURL.apply(c,arguments)},k.URL=i};if(b()||f(),k.location!==void 0&&!("origin"in k.location)){var g=function(){return k.location.protocol+"//"+k.location.hostname+(k.location.port?":"+k.location.port:"")};try{Object.defineProperty(k.location,"origin",{get:g,enumerable:!0})}catch{setInterval(function(){k.location.origin=g()},100)}}})(typeof x<"u"?x:typeof window<"u"?window:typeof self<"u"?self:x);var L={exports:{}};(function(k,b){(function(f,g){k.exports=g()})(window,function(){return function(f){var g={};function c(i){if(g[i])return g[i].exports;var a=g[i]={i,l:!1,exports:{}};return f[i].call(a.exports,a,a.exports,c),a.l=!0,a.exports}return c.m=f,c.c=g,c.d=function(i,a,p){c.o(i,a)||Object.defineProperty(i,a,{enumerable:!0,get:p})},c.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},c.t=function(i,a){if(1&a&&(i=c(i)),8&a||4&a&&typeof i=="object"&&i&&i.__esModule)return i;var p=Object.create(null);if(c.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:i}),2&a&&typeof i!="string")for(var u in i)c.d(p,u,(function(n){return i[n]}).bind(null,u));return p},c.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return c.d(a,"a",a),a},c.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)},c.p="",c(c.s=3)}([function(f,g){var c;c=function(){return this}();try{c=c||new Function("return this")()}catch{typeof window=="object"&&(c=window)}f.exports=c},function(f,g,c){(function(i){var a=c(2),p=setTimeout;function u(){}function n(r){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof r!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],v(r,this)}function o(r,l){for(;r._state===3;)r=r._value;r._state!==0?(r._handled=!0,n._immediateFn(function(){var d=r._state===1?l.onFulfilled:l.onRejected;if(d!==null){var m;try{m=d(r._value)}catch(w){return void s(l.promise,w)}t(l.promise,m)}else(r._state===1?t:s)(l.promise,r._value)})):r._deferreds.push(l)}function t(r,l){try{if(l===r)throw new TypeError("A promise cannot be resolved with itself.");if(l&&(typeof l=="object"||typeof l=="function")){var d=l.then;if(l instanceof n)return r._state=3,r._value=l,void h(r);if(typeof d=="function")return void v((m=d,w=l,function(){m.apply(w,arguments)}),r)}r._state=1,r._value=l,h(r)}catch(y){s(r,y)}var m,w}function s(r,l){r._state=2,r._value=l,h(r)}function h(r){r._state===2&&r._deferreds.length===0&&n._immediateFn(function(){r._handled||n._unhandledRejectionFn(r._value)});for(var l=0,d=r._deferreds.length;l<d;l++)o(r,r._deferreds[l]);r._deferreds=null}function e(r,l,d){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof l=="function"?l:null,this.promise=d}function v(r,l){var d=!1;try{r(function(m){d||(d=!0,t(l,m))},function(m){d||(d=!0,s(l,m))})}catch(m){if(d)return;d=!0,s(l,m)}}n.prototype.catch=function(r){return this.then(null,r)},n.prototype.then=function(r,l){var d=new this.constructor(u);return o(this,new e(r,l,d)),d},n.prototype.finally=a.a,n.all=function(r){return new n(function(l,d){if(!r||r.length===void 0)throw new TypeError("Promise.all accepts an array");var m=Array.prototype.slice.call(r);if(m.length===0)return l([]);var w=m.length;function y(C,E){try{if(E&&(typeof E=="object"||typeof E=="function")){var S=E.then;if(typeof S=="function")return void S.call(E,function(T){y(C,T)},d)}m[C]=E,--w==0&&l(m)}catch(T){d(T)}}for(var _=0;_<m.length;_++)y(_,m[_])})},n.resolve=function(r){return r&&typeof r=="object"&&r.constructor===n?r:new n(function(l){l(r)})},n.reject=function(r){return new n(function(l,d){d(r)})},n.race=function(r){return new n(function(l,d){for(var m=0,w=r.length;m<w;m++)r[m].then(l,d)})},n._immediateFn=typeof i=="function"&&function(r){i(r)}||function(r){p(r,0)},n._unhandledRejectionFn=function(r){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",r)},g.a=n}).call(this,c(5).setImmediate)},function(f,g,c){g.a=function(i){var a=this.constructor;return this.then(function(p){return a.resolve(i()).then(function(){return p})},function(p){return a.resolve(i()).then(function(){return a.reject(p)})})}},function(f,g,c){function i(e){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(e)}c(4);var a,p,u,n,o,t,s=c(8),h=(p=function(e){return new Promise(function(v,r){e=n(e),e=o(e);var l=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");l.open(e.method,e.url),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(e.headers).forEach(function(m){var w=e.headers[m];l.setRequestHeader(m,w)});var d=e.ratio;l.upload.addEventListener("progress",function(m){var w=Math.round(m.loaded/m.total*100),y=Math.ceil(w*d/100);e.progress(y)},!1),l.addEventListener("progress",function(m){var w=Math.round(m.loaded/m.total*100),y=Math.ceil(w*(100-d)/100)+d;e.progress(y)},!1),l.onreadystatechange=function(){if(l.readyState===4){var m=l.response;try{m=JSON.parse(m)}catch{}var w=s.parseHeaders(l.getAllResponseHeaders()),y={body:m,code:l.status,headers:w};l.status===200?v(y):r(y)}},l.send(e.data)})},u=function(e){return e.method="POST",p(e)},n=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(e.url&&typeof e.url!="string")throw new Error("Url must be a string");if(e.url=e.url||"",e.method&&typeof e.method!="string")throw new Error("`method` must be a string or null");if(e.method=e.method?e.method.toUpperCase():"GET",e.headers&&i(e.headers)!=="object")throw new Error("`headers` must be an object or null");if(e.headers=e.headers||{},e.type&&(typeof e.type!="string"||!Object.values(a).includes(e.type)))throw new Error("`type` must be taken from module's «contentType» library");if(e.progress&&typeof e.progress!="function")throw new Error("`progress` must be a function or null");if(e.progress=e.progress||function(v){},e.beforeSend=e.beforeSend||function(v){},e.ratio&&typeof e.ratio!="number")throw new Error("`ratio` must be a number");if(e.ratio<0||e.ratio>100)throw new Error("`ratio` must be in a 0-100 interval");if(e.ratio=e.ratio||90,e.accept&&typeof e.accept!="string")throw new Error("`accept` must be a string with a list of allowed mime-types");if(e.accept=e.accept||"*/*",e.multiple&&typeof e.multiple!="boolean")throw new Error("`multiple` must be a true or false");if(e.multiple=e.multiple||!1,e.fieldName&&typeof e.fieldName!="string")throw new Error("`fieldName` must be a string");return e.fieldName=e.fieldName||"files",e},o=function(e){switch(e.method){case"GET":var v=t(e.data,a.URLENCODED);delete e.data,e.url=/\?/.test(e.url)?e.url+"&"+v:e.url+"?"+v;break;case"POST":case"PUT":case"DELETE":case"UPDATE":var r=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).type||a.JSON}(e);(s.isFormData(e.data)||s.isFormElement(e.data))&&(r=a.FORM),e.data=t(e.data,r),r!==h.contentType.FORM&&(e.headers["content-type"]=r)}return e},t=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};switch(arguments.length>1?arguments[1]:void 0){case a.URLENCODED:return s.urlEncode(e);case a.JSON:return s.jsonEncode(e);case a.FORM:return s.formEncode(e);default:return e}},{contentType:a={URLENCODED:"application/x-www-form-urlencoded; charset=utf-8",FORM:"multipart/form-data",JSON:"application/json; charset=utf-8"},request:p,get:function(e){return e.method="GET",p(e)},post:u,transport:function(e){return e=n(e),s.selectFiles(e).then(function(v){for(var r=new FormData,l=0;l<v.length;l++)r.append(e.fieldName,v[l],v[l].name);return s.isObject(e.data)&&Object.keys(e.data).forEach(function(d){var m=e.data[d];r.append(d,m)}),e.beforeSend&&e.beforeSend(v),e.data=r,u(e)})},selectFiles:function(e){return delete(e=n(e)).beforeSend,s.selectFiles(e)}});f.exports=h},function(f,g,c){c.r(g);var i=c(1);window.Promise=window.Promise||i.a},function(f,g,c){(function(i){var a=i!==void 0&&i||typeof self<"u"&&self||window,p=Function.prototype.apply;function u(n,o){this._id=n,this._clearFn=o}g.setTimeout=function(){return new u(p.call(setTimeout,a,arguments),clearTimeout)},g.setInterval=function(){return new u(p.call(setInterval,a,arguments),clearInterval)},g.clearTimeout=g.clearInterval=function(n){n&&n.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(a,this._id)},g.enroll=function(n,o){clearTimeout(n._idleTimeoutId),n._idleTimeout=o},g.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},g._unrefActive=g.active=function(n){clearTimeout(n._idleTimeoutId);var o=n._idleTimeout;o>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},o))},c(6),g.setImmediate=typeof self<"u"&&self.setImmediate||i!==void 0&&i.setImmediate||this&&this.setImmediate,g.clearImmediate=typeof self<"u"&&self.clearImmediate||i!==void 0&&i.clearImmediate||this&&this.clearImmediate}).call(this,c(0))},function(f,g,c){(function(i,a){(function(p,u){if(!p.setImmediate){var n,o,t,s,h,e=1,v={},r=!1,l=p.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(p);d=d&&d.setTimeout?d:p,{}.toString.call(p.process)==="[object process]"?n=function(y){a.nextTick(function(){w(y)})}:function(){if(p.postMessage&&!p.importScripts){var y=!0,_=p.onmessage;return p.onmessage=function(){y=!1},p.postMessage("","*"),p.onmessage=_,y}}()?(s="setImmediate$"+Math.random()+"$",h=function(y){y.source===p&&typeof y.data=="string"&&y.data.indexOf(s)===0&&w(+y.data.slice(s.length))},p.addEventListener?p.addEventListener("message",h,!1):p.attachEvent("onmessage",h),n=function(y){p.postMessage(s+y,"*")}):p.MessageChannel?((t=new MessageChannel).port1.onmessage=function(y){w(y.data)},n=function(y){t.port2.postMessage(y)}):l&&"onreadystatechange"in l.createElement("script")?(o=l.documentElement,n=function(y){var _=l.createElement("script");_.onreadystatechange=function(){w(y),_.onreadystatechange=null,o.removeChild(_),_=null},o.appendChild(_)}):n=function(y){setTimeout(w,0,y)},d.setImmediate=function(y){typeof y!="function"&&(y=new Function(""+y));for(var _=new Array(arguments.length-1),C=0;C<_.length;C++)_[C]=arguments[C+1];var E={callback:y,args:_};return v[e]=E,n(e),e++},d.clearImmediate=m}function m(y){delete v[y]}function w(y){if(r)setTimeout(w,0,y);else{var _=v[y];if(_){r=!0;try{(function(C){var E=C.callback,S=C.args;switch(S.length){case 0:E();break;case 1:E(S[0]);break;case 2:E(S[0],S[1]);break;case 3:E(S[0],S[1],S[2]);break;default:E.apply(u,S)}})(_)}finally{m(y),r=!1}}}}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,c(0),c(7))},function(f,g){var c,i,a=f.exports={};function p(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function n(d){if(c===setTimeout)return setTimeout(d,0);if((c===p||!c)&&setTimeout)return c=setTimeout,setTimeout(d,0);try{return c(d,0)}catch{try{return c.call(null,d,0)}catch{return c.call(this,d,0)}}}(function(){try{c=typeof setTimeout=="function"?setTimeout:p}catch{c=p}try{i=typeof clearTimeout=="function"?clearTimeout:u}catch{i=u}})();var o,t=[],s=!1,h=-1;function e(){s&&o&&(s=!1,o.length?t=o.concat(t):h=-1,t.length&&v())}function v(){if(!s){var d=n(e);s=!0;for(var m=t.length;m;){for(o=t,t=[];++h<m;)o&&o[h].run();h=-1,m=t.length}o=null,s=!1,function(w){if(i===clearTimeout)return clearTimeout(w);if((i===u||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(w);try{i(w)}catch{try{return i.call(null,w)}catch{return i.call(this,w)}}}(d)}}function r(d,m){this.fun=d,this.array=m}function l(){}a.nextTick=function(d){var m=new Array(arguments.length-1);if(arguments.length>1)for(var w=1;w<arguments.length;w++)m[w-1]=arguments[w];t.push(new r(d,m)),t.length!==1||s||n(v)},r.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=l,a.addListener=l,a.once=l,a.off=l,a.removeListener=l,a.removeAllListeners=l,a.emit=l,a.prependListener=l,a.prependOnceListener=l,a.listeners=function(d){return[]},a.binding=function(d){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(d){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(f,g,c){function i(p,u){for(var n=0;n<u.length;n++){var o=u[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}var a=c(9);f.exports=function(){function p(){(function(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")})(this,p)}var u,n,o;return u=p,o=[{key:"urlEncode",value:function(t){return a(t)}},{key:"jsonEncode",value:function(t){return JSON.stringify(t)}},{key:"formEncode",value:function(t){if(this.isFormData(t))return t;if(this.isFormElement(t))return new FormData(t);if(this.isObject(t)){var s=new FormData;return Object.keys(t).forEach(function(h){var e=t[h];s.append(h,e)}),s}throw new Error("`data` must be an instance of Object, FormData or <FORM> HTMLElement")}},{key:"isObject",value:function(t){return Object.prototype.toString.call(t)==="[object Object]"}},{key:"isFormData",value:function(t){return t instanceof FormData}},{key:"isFormElement",value:function(t){return t instanceof HTMLFormElement}},{key:"selectFiles",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(s,h){var e=document.createElement("INPUT");e.type="file",t.multiple&&e.setAttribute("multiple","multiple"),t.accept&&e.setAttribute("accept",t.accept),e.style.display="none",document.body.appendChild(e),e.addEventListener("change",function(v){var r=v.target.files;s(r),document.body.removeChild(e)},!1),e.click()})}},{key:"parseHeaders",value:function(t){var s=t.trim().split(/[\r\n]+/),h={};return s.forEach(function(e){var v=e.split(": "),r=v.shift(),l=v.join(": ");r&&(h[r]=l)}),h}}],(n=null)&&i(u.prototype,n),o&&i(u,o),p}()},function(f,g){var c=function(a){return encodeURIComponent(a).replace(/[!'()*]/g,escape).replace(/%20/g,"+")},i=function(a,p,u,n){return p=p||null,u=u||"&",n=n||null,a?function(o){for(var t=new Array,s=0;s<o.length;s++)o[s]&&t.push(o[s]);return t}(Object.keys(a).map(function(o){var t,s,h=o;if(n&&(h=n+"["+h+"]"),typeof a[o]=="object"&&a[o]!==null)t=i(a[o],null,u,h);else{p&&(s=h,h=!isNaN(parseFloat(s))&&isFinite(s)?p+Number(h):h);var e=a[o];e=(e=(e=(e=e===!0?"1":e)===!1?"0":e)===0?"0":e)||"",t=c(h)+"="+c(e)}return t})).join(u).replace(/[!'()*]/g,""):""};f.exports=i}])})})(L);var j=L.exports;const P=O(j),R='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7.69998 12.6L7.67896 12.62C6.53993 13.7048 6.52012 15.5155 7.63516 16.625V16.625C8.72293 17.7073 10.4799 17.7102 11.5712 16.6314L13.0263 15.193C14.0703 14.1609 14.2141 12.525 13.3662 11.3266L13.22 11.12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16.22 11.12L16.3564 10.9805C17.2895 10.0265 17.3478 8.5207 16.4914 7.49733V7.49733C15.569 6.39509 13.9269 6.25143 12.8271 7.17675L11.39 8.38588C10.0935 9.47674 9.95704 11.4241 11.0887 12.6852L11.12 12.72"/></svg>';class F{static get isReadOnlySupported(){return!0}static get toolbox(){return{icon:R,title:"Link"}}static get enableLineBreaks(){return!0}constructor({data:b,config:f,api:g,readOnly:c}){this.api=g,this.readOnly=c,this.config={endpoint:f.endpoint||"",headers:f.headers||{}},this.nodes={wrapper:null,container:null,progress:null,input:null,inputHolder:null,linkContent:null,linkImage:null,linkTitle:null,linkDescription:null,linkText:null},this._data={link:"",meta:{}},this.data=b}render(){return this.nodes.wrapper=this.make("div",this.CSS.baseClass),this.nodes.container=this.make("div",this.CSS.container),this.nodes.inputHolder=this.makeInputHolder(),this.nodes.linkContent=this.prepareLinkPreview(),Object.keys(this.data.meta).length?(this.nodes.container.appendChild(this.nodes.linkContent),this.showLinkPreview(this.data.meta)):this.nodes.container.appendChild(this.nodes.inputHolder),this.nodes.wrapper.appendChild(this.nodes.container),this.nodes.wrapper}save(){return this.data}validate(){return this.data.link.trim()!==""}set data(b){this._data=Object.assign({},{link:b.link||this._data.link,meta:b.meta||this._data.meta})}get data(){return this._data}get CSS(){return{baseClass:this.api.styles.block,input:this.api.styles.input,container:"link-tool",inputEl:"link-tool__input",inputHolder:"link-tool__input-holder",inputError:"link-tool__input-holder--error",linkContent:"link-tool__content",linkContentRendered:"link-tool__content--rendered",linkImage:"link-tool__image",linkTitle:"link-tool__title",linkDescription:"link-tool__description",linkText:"link-tool__anchor",progress:"link-tool__progress",progressLoading:"link-tool__progress--loading",progressLoaded:"link-tool__progress--loaded"}}makeInputHolder(){const b=this.make("div",this.CSS.inputHolder);return this.nodes.progress=this.make("label",this.CSS.progress),this.nodes.input=this.make("div",[this.CSS.input,this.CSS.inputEl],{contentEditable:!this.readOnly}),this.nodes.input.dataset.placeholder=this.api.i18n.t("Link"),this.readOnly||(this.nodes.input.addEventListener("paste",f=>{this.startFetching(f)}),this.nodes.input.addEventListener("keydown",f=>{const[g,c]=[13,65],i=f.ctrlKey||f.metaKey;switch(f.keyCode){case g:f.preventDefault(),f.stopPropagation(),this.startFetching(f);break;case c:i&&this.selectLinkUrl(f);break}})),b.appendChild(this.nodes.progress),b.appendChild(this.nodes.input),b}startFetching(b){let f=this.nodes.input.textContent;b.type==="paste"&&(f=(b.clipboardData||window.clipboardData).getData("text")),this.removeErrorStyle(),this.fetchLinkData(f)}removeErrorStyle(){this.nodes.inputHolder.classList.remove(this.CSS.inputError),this.nodes.inputHolder.insertBefore(this.nodes.progress,this.nodes.input)}selectLinkUrl(b){b.preventDefault(),b.stopPropagation();const f=window.getSelection(),g=new Range,c=f.anchorNode.parentNode.closest(`.${this.CSS.inputHolder}`).querySelector(`.${this.CSS.inputEl}`);g.selectNodeContents(c),f.removeAllRanges(),f.addRange(g)}prepareLinkPreview(){const b=this.make("a",this.CSS.linkContent,{target:"_blank",rel:"nofollow noindex noreferrer"});return this.nodes.linkImage=this.make("div",this.CSS.linkImage),this.nodes.linkTitle=this.make("div",this.CSS.linkTitle),this.nodes.linkDescription=this.make("p",this.CSS.linkDescription),this.nodes.linkText=this.make("span",this.CSS.linkText),b}showLinkPreview({image:b,title:f,description:g}){this.nodes.container.appendChild(this.nodes.linkContent),b&&b.url&&(this.nodes.linkImage.style.backgroundImage="url("+b.url+")",this.nodes.linkContent.appendChild(this.nodes.linkImage)),f&&(this.nodes.linkTitle.textContent=f,this.nodes.linkContent.appendChild(this.nodes.linkTitle)),g&&(this.nodes.linkDescription.textContent=g,this.nodes.linkContent.appendChild(this.nodes.linkDescription)),this.nodes.linkContent.classList.add(this.CSS.linkContentRendered),this.nodes.linkContent.setAttribute("href",this.data.link),this.nodes.linkContent.appendChild(this.nodes.linkText);try{this.nodes.linkText.textContent=new URL(this.data.link).hostname}catch{this.nodes.linkText.textContent=this.data.link}}showProgress(){this.nodes.progress.classList.add(this.CSS.progressLoading)}hideProgress(){return new Promise(b=>{this.nodes.progress.classList.remove(this.CSS.progressLoading),this.nodes.progress.classList.add(this.CSS.progressLoaded),setTimeout(b,500)})}applyErrorStyle(){this.nodes.inputHolder.classList.add(this.CSS.inputError),this.nodes.progress.remove()}async fetchLinkData(b){this.showProgress(),this.data={link:b};try{const{body:f}=await P.get({url:this.config.endpoint,headers:this.config.headers,data:{url:b}});this.onFetch(f)}catch{this.fetchingFailed(this.api.i18n.t("Couldn't fetch the link data"))}}onFetch(b){if(!b||!b.success){this.fetchingFailed(this.api.i18n.t("Couldn't get this link data, try the other one"));return}const f=b.meta,g=b.link||this.data.link;if(this.data={meta:f,link:g},!f){this.fetchingFailed(this.api.i18n.t("Wrong response format from the server"));return}this.hideProgress().then(()=>{this.nodes.inputHolder.remove(),this.showLinkPreview(f)})}fetchingFailed(b){this.api.notifier.show({message:b,style:"error"}),this.applyErrorStyle()}make(b,f=null,g={}){const c=document.createElement(b);Array.isArray(f)?c.classList.add(...f):f&&c.classList.add(f);for(const i in g)c[i]=g[i];return c}}export{F as default};
